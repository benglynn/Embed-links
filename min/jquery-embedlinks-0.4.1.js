(function(f){function e(a,b){this.id=a;this.urlSchemeStart=b;this.apiEndPoint="http://oohembed.com/oohembed/"}function l(a,b){e.call(this,a,b)}function m(a,b){e.call(this,a,b)}function g(a,b){e.call(this,a,b)}function n(a,b){e.call(this,a,b)}var r={maxwidth:800,maxheight:800};(function(){if(window.console&&navigator.userAgent.match(/Firefox/)!==null)console.log.apply(this,arguments);else arguments[0]&&window.console&&console.log(arguments[0].toString())})();e.prototype.handlesUrl=function(a){return a.indexOf(this.urlSchemeStart)===
0||a.indexOf(this.urlSchemeStart.match(/^http:\/\/www\./)?"http://"+this.urlSchemeStart.substring(11):"http://www."+this.urlSchemeStart.substring(7))===0};e.prototype.embedLink=function(a,b){var c=f.extend({},r,b),d=this.apiEndPoint+"?url="+escape(a.attr("href"))+"&format=json&maxwidth="+c.maxwidth+"&maxheight="+c.maxheight+"&callback=?",i=this;f.getJSON(d,function(j){i.onJson(j,a,c)})};e.prototype.parseData=function(a){var b={};b.width=parseInt(a.width,10);b.height=parseInt(a.height,10);return b};
e.prototype.validateData=function(a,b){for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];if(typeof d==="number"&&isNaN(d)||typeof d==="undefined")return false}c=a.width<b.maxwidth&&a.height<b.maxheight?[a.width,a.height]:a.width>a.height?[a.width*b.maxwidth/a.width,a.height*b.maxwidth/a.width]:[a.width*b.maxheight/a.height,a.height*b.maxheight/a.height];a.width=c[0];a.height=c[1];if(b.controlerHeight)a.height+=b.controlerHeight;return true};e.prototype.onJson=function(a,b,c){var d=this.parseData(a);
this.validateData(d,c)&&this.render(d,b,a,c);return d};e.prototype.render=function(){};l.prototype=new e;l.prototype.parseData=function(a){var b=e.prototype.parseData.call(this,a);b.url=a.url;return b};l.prototype.render=function(a,b){b.replaceWith('<img width="'+a.width+'" height="'+a.height+'" src="'+a.url+'"/>')};m.prototype=new e;m.prototype.parseData=function(a){var b=e.prototype.parseData.call(this,a);if(a.html&&a.html.match(/^<iframe/))b.html=a.html;return b};m.prototype.render=function(a,
b){a.html&&b.after(a.html).remove()};g.prototype=new e;g.prototype.parseData=function(a){var b=e.prototype.parseData.call(this,a);b.flashSrc=undefined;if(a.html&&a.html.match(/^<(?:object|embed).*?type=(?:\"|')application\/x-shockwave-flash(?:\"|')/i)!==null)b.flashSrc=a.html.match(/^<(?:object|embed).*?(?:src|data)=(?:"|')([^'"]*?)(?:"|')/i)[1];return b};g.prototype.render=function(a,b,c,d){if(swfobject&&swfobject.hasFlashPlayerVersion("9.0.0")){var i=b.attr("id")?b.attr("id"):Math.random().toString().replace(/^0\./,
"jquery_embedlinks_");b.attr("id",i);var j={};b=c.html.match(/<param name=(?:'|").*?(?:'|")\s+?value=(?:'|").*?(?:'|")/gi);b!==null&&f.each(b,function(p,o){var q=o.match(/<param name=(?:'|")(.*?)(?:'|")\s+?value=(?:'|")(.*?)(?:'|")/i);j[q[1]]=q[2]});j.allowFullScreen="true";d=d[this.id+"_querystring"];var h=a.flashSrc;if(d!==undefined){h+=h.match(/\?/)===null?"?":"&";f.each(d,function(p,o){h+=p+"="+o+"&"});h=h.replace(/&$/,"")}swfobject.embedSWF(h,i,a.width+"",a.height+"","9.0.0",null,null,j,{id:i+
"_id"})}};n.prototype=new g;n.prototype.onJson=function(a,b,c){a.width=640;a.height=360;g.prototype.onJson(a,b,c)};var k=[new n("youtube","http://www.youtube.com/watch?v="),new m("vimeo","http://vimeo.com/"),new l("flickr","http://www.flickr.com/photos/"),new g("qik","http://qik.com/")];f.fn.embedLinks=function(a){if(navigator.appVersion.match(/MSIE 6/)==null)return this.each(function(){if(this.nodeName==="A"){var b=f(this),c;a:{c=b.attr("href");for(var d=0;d<k.length;d++)if(k[d].handlesUrl(c)){c=
k[d];break a}c=null}c!==null&&c.embedLink(b,a)}})};f.embedLinks=function(a){var b="";f.each(k,function(c,d){b+="a[href^="+d.urlSchemeStart+"], ";b+=d.urlSchemeStart.match(/^http:\/\/www\./)?"a[href^=http://"+d.urlSchemeStart.substring(11)+"]":"a[href^=http://www."+d.urlSchemeStart.substring(7)+"]";if(c<k.length-1)b+=","});f(b).embedLinks(a)}})(jQuery);
